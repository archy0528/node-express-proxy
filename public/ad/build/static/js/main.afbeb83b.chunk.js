(this["webpackJsonpempf-login"]=this["webpackJsonpempf-login"]||[]).push([[0],{331:function(e,t,n){"use strict";n.r(t);var r=n(0),a=n.n(r),i=n(11),c=n.n(i),s=n(63),o=n(155),l=n(375),u=n(376),j=n(85),d=n(377),b=n(31),h=n(38),O=n(42),f=n(21),p=Object(h.c)({}).getInitialState({isAuthenticating:!0,isLoading:!1,error:null,user:null,expires:null}),g=n(116),x=n.n(g),m=n(156),v=n(12),y=n(13),C=n(23),w=n(24),k=n(8),S=n(157),P=n.n(S),F=new(function(e){Object(C.a)(n,e);var t=Object(w.a)(n);function n(){return Object(v.a)(this,n),t.apply(this,arguments)}return Object(y.a)(n,[{key:"login",value:function(e){return this.instance.post("/ad/api/auth/login",e)}},{key:"userinfo",value:function(){return this.instance.get("/ad/api/auth/userinfo")}}]),n}(function(){function e(t){Object(v.a)(this,e),this.instance=P.a.create(Object(k.a)(Object(k.a)({},t),{},{withCredentials:!0})),this.instance.interceptors.request.use((function(e){return e}),(function(e){return Promise.reject(e)})),this.instance.interceptors.response.use((function(e){var t,n,r=null===(t=e.data)||void 0===t?void 0:t.errorCode,a=null===(n=e.data)||void 0===n?void 0:n.errorMessage;return r>=400?Promise.reject(a):e.data}),(function(e){if(e.response){var t,n,r=null===(t=e.response)||void 0===t||null===(n=t.data)||void 0===n?void 0:n.errorMessage;if(r)return Promise.reject(r)}else{if(!e.request)return Promise.reject(e.message);if("ECONNABORTED"===e.code)return Promise.reject("Couldn't search at this moment. Please try again later.")}return Promise.reject("Couldn't search at this moment. Please try again later.")}))}return Object(y.a)(e,[{key:"get",value:function(e,t){return this.instance.get(e,t)}},{key:"post",value:function(e,t,n){return this.instance.post(e,t,n)}},{key:"put",value:function(e,t,n){return this.instance.put(e,t,n)}},{key:"delete",value:function(e,t,n){return this.instance.delete(e,t,n)}}]),e}())),I=Object(h.b)("@@EMPF/USER/LOGIN",function(){var e=Object(m.a)(x.a.mark((function e(t,n){var r,a;return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=n.rejectWithValue,e.prev=1,e.next=4,F.login(t);case 4:return e.next=6,F.userinfo();case 6:return a=e.sent,e.abrupt("return",{user:a});case 10:return e.prev=10,e.t0=e.catch(1),e.abrupt("return",r({error:e.t0}));case 13:case"end":return e.stop()}}),e,null,[[1,10]])})));return function(t,n){return e.apply(this,arguments)}}()),L=n(158),T={key:"user",storage:n.n(L).a,blacklist:["isAuthenticating","isLoading","error"]},B=Object(h.d)(p,(function(e){return e.addCase(I.pending,(function(e,t){e.isLoading=!0,e.error=null})).addCase(I.fulfilled,(function(e,t){e.isLoading=!1,e.user=t.payload.user})).addCase(I.rejected,(function(e,t){e.isLoading=!1,e.error=t.payload.error}))})),N=Object(O.g)(T,B),z=Object(f.c)({user:N});var A=n(77),E=n(159),H=n(160),M=n(162),W=[{code:"en-US",lang:"English"},{code:"zh-CN",lang:"Chinese (Simplified)"},{code:"zh-HK",lang:"Chinese (Traditional)"}];A.a.use(E.a),A.a.use(H.a),A.a.init({debug:!1,fallbackLng:"en-US",whitelist:Object(M.map)(W,"code"),backend:{loadPath:"".concat("/ad","/locales/i18n/{{lng}}/{{ns}}.json")}});var R=A.a,D=n(175),q=Object(D.a)({palette:{primary:{main:"#0D6A88"}},mixins:{toolbar:{minHeight:51}},typography:{fontFamily:["Roboto","Helvetica","Arial","sans-serif"].join(",")}});q.overrides={MuiButton:{contained:{borderRadius:40}}},q.props={MuiAppBar:{position:"fixed",elevation:0},MuiToolbar:{variant:"dense"},MuiTextField:{margin:"none",variant:"outlined",size:"small",fullWidth:!0},MuiButton:{variant:"contained",color:"primary"}};var G=q,K=n(17),U=n(40),J=n(47),V=n(4),Q=Object(r.createContext)(),X=Q.Provider,Y=function(e,t){switch(t.type){case"settingsToggled":return Object(k.a)(Object(k.a)({},e),{},{settingsOpen:!e.settingsOpen});default:return e}},Z=function(e){var t=e.children,n=Object(r.useReducer)(Y,{settingsOpen:!1}),a=Object(J.a)(n,2),i=a[0],c=a[1],s=Object(r.useCallback)((function(){return c({type:"settingsToggled"})}),[c]);return Object(V.jsx)(X,{value:Object(k.a)(Object(k.a)({},i),{},{settingsToggled:s}),children:t})},$=function(){return Object(r.useContext)(Q)},_=n(365),ee=n(383),te=n(366),ne=n(367),re=n(368),ae=n(369),ie=n(177),ce=function(e){return Object(V.jsx)(ie.a,Object(k.a)(Object(k.a)({},e),{},{children:Object(V.jsxs)("g",{transform:"translate(-1249.5 -17)",children:[Object(V.jsx)("rect",{width:23,height:23,rx:4,transform:"translate(1249.5 17)",fill:"#fff"}),Object(V.jsx)("text",{transform:"translate(1252.5 35)",fill:"#02a0cf",fontSize:17,fontFamily:"PingFangHK-Semibold,PingFang HK",fontWeight:600,children:Object(V.jsx)("tspan",{x:0,y:0,children:"\u4e2d"})})]})}))},se=Object(_.a)((function(e){return{appBar:{zIndex:e.zIndex.drawer+1},title:{fontStyle:"italic",fontWeight:e.typography.fontWeightBold,margin:e.spacing(0,1,0,2)},subtitle:{flexGrow:1}}})),oe=function(){var e=se(),t=$().settingsToggled,n=Object(ee.a)(["header"]).t;return Object(V.jsx)(te.a,{className:e.appBar,children:Object(V.jsxs)(ne.a,{children:[Object(V.jsx)(re.a,{className:e.title,variant:"h6",children:n("header:title")}),Object(V.jsx)(re.a,{className:e.subtitle,variant:"body1",children:n("header:subtitle")}),Object(V.jsx)(ae.a,{onClick:t,children:Object(V.jsx)(ce,{fontSize:"small"})})]})})},le=n(379),ue=n(382),je=Object(_.a)((function(e){return{paper:{width:240,border:0,boxShadow:"0px 2px 10px #BFBEBE96"},container:{overflow:"auto"}}})),de=function(e){var t=e.children,n=Object(U.a)(e,["children"]),r=je();return Object(V.jsx)(ue.a,Object(k.a)(Object(k.a)({classes:{paper:r.paper}},n),{},{children:Object(V.jsx)("div",{className:r.container,children:t})}))},be=n(46),he=n(171),Oe=n.n(he),fe=n(84),pe=function(e){return e.user},ge=Object(fe.a)(pe,(function(e){return e.user})),xe=Object(fe.a)(pe,(function(e){return e.isLoading})),me=Object(fe.a)(pe,(function(e){return e.error})),ve=function(e){return Object(s.b)((function(e){return{user:ge(e)}}))((function(t){var n=t.user,a=Object(U.a)(t,["user"]),i=Object(K.f)().pathname;return Object(r.useEffect)((function(){n&&"/ad/sec"!==i&&(window.location.href="/ad/sec")}),[n,i]),n?null:Object(V.jsx)(e,Object(k.a)({},a))}))},ye=function(e){return function(t){var n=Object(be.useField)(t),r=Object(J.a)(n,3),a=r[0],i=r[1],c=r[2],s=i.touched,o=i.error;return Object(V.jsx)(e,Object(k.a)(Object(k.a)({error:s&&o&&!0,helperText:s&&o,helpers:c},a),t))}},Ce=n(378),we=ye((function(e){e.helpers;var t=Object(U.a)(e,["helpers"]);return Object(V.jsx)(Ce.a,Object(k.a)({},t))})),ke=n(370),Se=function(e){var t=Object(be.useFormikContext)().handleSubmit;return Object(V.jsx)(ke.a,Object(k.a)({type:"submit",onClick:t},e))},Pe=function(e){var t=e.children,n=Object(U.a)(e,["children"]),r=Object(be.useFormikContext)(),a=r.handleSubmit,i=r.handleReset;return Object(V.jsxs)("form",Object(k.a)(Object(k.a)({onSubmit:a,onReset:i,autoComplete:"off"},n),{},{children:[t,Object(V.jsx)(Oe.a,{offset:0,align:"middle",focusDelay:200,ease:"linear",duration:200})]}))};Pe.Input=we,Pe.Submit=Se;var Fe=Pe,Ie=n(384),Le=function(){var e=Object(ee.a)("translation").i18n;return Object(V.jsx)(Ce.a,{select:!0,label:"Language",variant:"outlined",size:"small",fullWidth:!0,value:e.language,onChange:function(t){e.changeLanguage(t.target.value)},children:W.map((function(e){return Object(V.jsx)(Ie.a,{value:e.code,children:e.lang},e.code)}))})},Te=function(){var e=$(),t=e.settingsOpen,n=e.settingsToggled;return Object(V.jsx)(de,{variant:"temporary",anchor:"right",open:t,onClose:n,children:Object(V.jsx)(le.a,{p:3,children:Object(V.jsx)(Le,{})})})},Be=Object(_.a)((function(e){return{root:{display:"flex",minHeight:"100vh"},content:{flexGrow:1,overflow:"hidden",padding:e.spacing(3)}}})),Ne=function(e){var t=e.children,n=Object(U.a)(e,["children"]),r=Be();return Object(V.jsxs)(Z,{children:[Object(V.jsxs)("div",{className:r.root,children:[Object(V.jsx)(oe,Object(k.a)({},n)),Object(V.jsx)("main",{className:r.content,children:t})]}),Object(V.jsx)(Te,{})]})},ze=ve((function(){return null})),Ae=n(101),Ee=n(371),He=n(372),Me=n(385),We=n(380),Re=n(373),De=n(374),qe={username:"",password:""},Ge=Ae.a().shape({username:Ae.b().required(),password:Ae.b().required()}),Ke=Object(_.a)((function(e){return{container:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",minHeight:"calc(100vh - ".concat(e.mixins.toolbar.minHeight,"px)")},avatar:{width:e.spacing(8),height:e.spacing(8),backgroundColor:e.palette.primary.main}}})),Ue=Object(s.b)((function(e){return{isLoading:xe(e),error:me(e)}}),(function(e){return Object(k.a)({},Object(f.b)({login:I},e))})),Je=Object(f.d)(ve,Ue)((function(e){var t=e.isLoading,n=e.error,r=e.login,a=Ke(),i=Object(ee.a)(["typography","form","button"]).t;return Object(V.jsx)(Ee.a,{className:a.container,maxWidth:"xs",children:Object(V.jsx)(be.Formik,{initialValues:qe,validationSchema:Ge,onSubmit:function(e){r(e)},children:Object(V.jsx)(Fe,{children:Object(V.jsxs)(He.a,{container:!0,spacing:2,children:[Object(V.jsx)(He.a,{item:!0,xs:12,align:"middle",children:Object(V.jsx)(Me.a,{className:a.avatar,children:Object(V.jsx)(Re.a,{fontSize:"large"})})}),Object(V.jsx)(He.a,{item:!0,xs:12,align:"middle",children:Object(V.jsx)(re.a,{component:"h1",variant:"h5",children:i("typography:heading.signIn")})}),n&&Object(V.jsx)(He.a,{item:!0,xs:12,children:Object(V.jsx)(We.a,{severity:"error",children:n})}),Object(V.jsx)(He.a,{item:!0,xs:12,children:Object(V.jsx)(Fe.Input,{label:i("form:label.username"),name:"username",InputProps:{startAdornment:Object(V.jsx)(De.a,{})}})}),Object(V.jsx)(He.a,{item:!0,xs:12,children:Object(V.jsx)(Fe.Input,{type:"password",label:i("form:label.password"),name:"password",InputProps:{startAdornment:Object(V.jsx)(Re.a,{})}})}),Object(V.jsx)(He.a,{item:!0,xs:12,align:"middle",children:Object(V.jsx)(Fe.Submit,{disabled:t,fullWidth:!0,children:i("button:signIn")})})]})})})})})),Ve=function(e){return Object(V.jsx)(Ne,Object(k.a)(Object(k.a)({},e),{},{children:Object(V.jsxs)(K.c,{children:[Object(V.jsx)(K.a,{exact:!0,path:"/",component:Je}),Object(V.jsx)(K.a,{path:"",component:ze})]})}))},Qe=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,388)).then((function(t){var n=t.getCLS,r=t.getFID,a=t.getFCP,i=t.getLCP,c=t.getTTFB;n(e),r(e),a(e),i(e),c(e)}))},Xe=function(e){var t=Object(h.a)({reducer:z,middleware:[].concat(Object(b.a)(Object(h.e)({serializableCheck:{ignoredActions:[O.a,O.f,O.b,O.c,O.d,O.e]}})),[]),preloadedState:e,devTools:!1});return{store:t,persistor:Object(O.h)(t)}}({}),Ye=Xe.store,Ze=Xe.persistor;c.a.render(Object(V.jsx)(a.a.Suspense,{fallback:null,children:Object(V.jsx)(s.a,{store:Ye,children:Object(V.jsx)(o.a,{loading:null,persistor:Ze,children:Object(V.jsx)(l.a,{i18n:R,children:Object(V.jsx)(u.a,{theme:G,children:Object(V.jsxs)(j.a,{basename:"/ad",children:[Object(V.jsx)(d.a,{}),Object(V.jsx)(Ve,{})]})})})})})}),document.getElementById("root")),Qe()}},[[331,1,2]]]);
//# sourceMappingURL=main.afbeb83b.chunk.js.map