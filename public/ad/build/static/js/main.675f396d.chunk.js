(this["webpackJsonpempf-login"]=this["webpackJsonpempf-login"]||[]).push([[0],{331:function(e,t,n){"use strict";n.r(t);var r=n(0),a=n.n(r),i=n(11),c=n.n(i),s=n(63),o=n(156),l=n(375),u=n(376),j=n(85),d=n(377),b=n(31),O=n(37),h=n(48),f=n(157),p=n.n(f),g=n(21),x=n(7),m=Object(O.d)({}).getInitialState({token:null,user:null,isLoading:!1,error:null}),v=n(117),y=n.n(v),k=n(158),C=n(12),w=n(13),S=n(23),P=n(24),T=n(159),F=n.n(T),B=function(){function e(t){Object(C.a)(this,e),this.instance=F.a.create(t),this.instance.interceptors.request.use((function(e){return e}),(function(e){return Promise.reject(e)})),this.instance.interceptors.response.use((function(e){var t,n,r=null===(t=e.data)||void 0===t?void 0:t.errorCode,a=null===(n=e.data)||void 0===n?void 0:n.errorMessage;return r>=400?Promise.reject(a):e.data}),(function(e){if(e.response){var t,n,r=null===(t=e.response)||void 0===t||null===(n=t.data)||void 0===n?void 0:n.errorMessage;if(r)return Promise.reject(r)}else{if(!e.request)return Promise.reject(e.message);if("ECONNABORTED"===e.code)return Promise.reject("Couldn't search at this moment. Please try again later.")}return Promise.reject("Couldn't search at this moment. Please try again later.")}))}return Object(w.a)(e,[{key:"get",value:function(e,t){return this.instance.get(e,t)}},{key:"post",value:function(e,t,n){return this.instance.post(e,t,n)}},{key:"put",value:function(e,t,n){return this.instance.put(e,t,n)}},{key:"delete",value:function(e,t,n){return this.instance.delete(e,t,n)}}]),e}(),L=n(88),I=new(function(e){Object(S.a)(n,e);var t=Object(P.a)(n);function n(){return Object(C.a)(this,n),t.apply(this,arguments)}return Object(w.a)(n,[{key:"login",value:function(e){var t=Object(L.pick)(e,["username","password"]);return this.instance.post("/api/auth/login",t)}},{key:"getByToken",value:function(e){return this.instance.get("/api/auth/userinfo",{headers:{Authorization:"Bearer ".concat(e)}})}}]),n}(B))({baseURL:""}),N=Object(O.c)("@@EMPF/USER/LOGIN",function(){var e=Object(k.a)(y.a.mark((function e(t,n){var r,a,i,c;return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=n.rejectWithValue,e.prev=1,e.next=4,I.login(t);case 4:return a=e.sent,i=a.sessionToken,e.next=8,I.getByToken(i);case 8:return c=e.sent,e.abrupt("return",{token:i,user:c});case 12:return e.prev=12,e.t0=e.catch(1),e.abrupt("return",r({error:e.t0}));case 15:case"end":return e.stop()}}),e,null,[[1,12]])})));return function(t,n){return e.apply(this,arguments)}}()),z=Object(O.b)("@@EMPF/USER/LOGOUT",(function(){return{payload:{}}})),E=Object(O.e)(m,(function(e){return e.addCase(N.pending,(function(e,t){return Object(x.a)(Object(x.a)({},e),{},{isLoading:!0,error:null})})).addCase(N.fulfilled,(function(e,t){var n=t.payload,r=n.token,a=n.user;return Object(x.a)(Object(x.a)({},e),{},{isLoading:!1,error:null,token:r,user:a})})).addCase(N.rejected,(function(e,t){var n=t.payload.error;return Object(x.a)(Object(x.a)({},e),{},{isLoading:!1,error:n})})).addCase(z,(function(e,t){return Object(x.a)(Object(x.a)({},e),{},{token:null,user:null})}))})),M=Object(g.c)({user:E});var R=n(77),A=n(160),H=n(161),W=[{code:"en-US",lang:"English"},{code:"zh-CN",lang:"Chinese (Simplified)"},{code:"zh-HK",lang:"Chinese (Traditional)"}];R.a.use(A.a),R.a.use(H.a),R.a.init({debug:!1,fallbackLng:"en-US",whitelist:Object(L.map)(W,"code"),backend:{loadPath:"".concat("/ad","/locales/i18n/{{lng}}/{{ns}}.json")}});var U=R.a,D=n(175),q=Object(D.a)({palette:{primary:{main:"#0D6A88"}},mixins:{toolbar:{minHeight:51}},typography:{fontFamily:["Roboto","Helvetica","Arial","sans-serif"].join(",")}});q.overrides={MuiButton:{contained:{borderRadius:40}}},q.props={MuiAppBar:{position:"fixed",elevation:0},MuiToolbar:{variant:"dense"},MuiTextField:{margin:"none",variant:"outlined",size:"small",fullWidth:!0},MuiButton:{variant:"contained",color:"primary"}};var G=q,K=n(17),J=n(40),V=n(46),Q=n(4),X=Object(r.createContext)(),Y=X.Provider,Z=function(e,t){switch(t.type){case"settingsToggled":return Object(x.a)(Object(x.a)({},e),{},{settingsOpen:!e.settingsOpen});default:return e}},$=function(e){var t=e.children,n=Object(r.useReducer)(Z,{settingsOpen:!1}),a=Object(V.a)(n,2),i=a[0],c=a[1],s=Object(r.useCallback)((function(){return c({type:"settingsToggled"})}),[c]);return Object(Q.jsx)(Y,{value:Object(x.a)(Object(x.a)({},i),{},{settingsToggled:s}),children:t})},_=function(){return Object(r.useContext)(X)},ee=n(365),te=n(383),ne=n(366),re=n(367),ae=n(368),ie=n(369),ce=n(177),se=function(e){return Object(Q.jsx)(ce.a,Object(x.a)(Object(x.a)({},e),{},{children:Object(Q.jsxs)("g",{transform:"translate(-1249.5 -17)",children:[Object(Q.jsx)("rect",{width:23,height:23,rx:4,transform:"translate(1249.5 17)",fill:"#fff"}),Object(Q.jsx)("text",{transform:"translate(1252.5 35)",fill:"#02a0cf",fontSize:17,fontFamily:"PingFangHK-Semibold,PingFang HK",fontWeight:600,children:Object(Q.jsx)("tspan",{x:0,y:0,children:"\u4e2d"})})]})}))},oe=Object(ee.a)((function(e){return{appBar:{zIndex:e.zIndex.drawer+1},title:{fontStyle:"italic",fontWeight:e.typography.fontWeightBold,margin:e.spacing(0,1,0,2)},subtitle:{flexGrow:1}}})),le=function(){var e=oe(),t=_().settingsToggled,n=Object(te.a)(["header"]).t;return Object(Q.jsx)(ne.a,{className:e.appBar,children:Object(Q.jsxs)(re.a,{children:[Object(Q.jsx)(ae.a,{className:e.title,variant:"h6",children:n("header:title")}),Object(Q.jsx)(ae.a,{className:e.subtitle,variant:"body1",children:n("header:subtitle")}),Object(Q.jsx)(ie.a,{onClick:t,children:Object(Q.jsx)(se,{fontSize:"small"})})]})})},ue=n(379),je=n(382),de=Object(ee.a)((function(e){return{paper:{width:240,border:0,boxShadow:"0px 2px 10px #BFBEBE96"},container:{overflow:"auto"}}})),be=function(e){var t=e.children,n=Object(J.a)(e,["children"]),r=de();return Object(Q.jsx)(je.a,Object(x.a)(Object(x.a)({classes:{paper:r.paper}},n),{},{children:Object(Q.jsx)("div",{className:r.container,children:t})}))},Oe=n(45),he=n(171),fe=n.n(he),pe=n(84),ge=function(e){return e.user},xe=Object(pe.a)(ge,(function(e){return e.user})),me=Object(pe.a)(ge,(function(e){return e.isLoading})),ve=Object(pe.a)(ge,(function(e){return e.error})),ye=function(e){return Object(s.b)((function(e){return{user:xe(e)}}))((function(t){var n=t.user,a=Object(J.a)(t,["user"]),i=Object(K.f)().pathname;return Object(r.useEffect)((function(){n&&"/ad/sec"!==i&&(window.location.href="/ad/sec")}),[n,i]),n?null:Object(Q.jsx)(e,Object(x.a)({},a))}))},ke=function(e){return function(t){var n=Object(Oe.useField)(t),r=Object(V.a)(n,3),a=r[0],i=r[1],c=r[2],s=i.touched,o=i.error;return Object(Q.jsx)(e,Object(x.a)(Object(x.a)({error:s&&o&&!0,helperText:s&&o,helpers:c},a),t))}},Ce=n(378),we=ke((function(e){e.helpers;var t=Object(J.a)(e,["helpers"]);return Object(Q.jsx)(Ce.a,Object(x.a)({},t))})),Se=n(370),Pe=function(e){var t=Object(Oe.useFormikContext)().handleSubmit;return Object(Q.jsx)(Se.a,Object(x.a)({type:"submit",onClick:t},e))},Te=function(e){var t=e.children,n=Object(J.a)(e,["children"]),r=Object(Oe.useFormikContext)(),a=r.handleSubmit,i=r.handleReset;return Object(Q.jsxs)("form",Object(x.a)(Object(x.a)({onSubmit:a,onReset:i,autoComplete:"off"},n),{},{children:[t,Object(Q.jsx)(fe.a,{offset:0,align:"middle",focusDelay:200,ease:"linear",duration:200})]}))};Te.Input=we,Te.Submit=Pe;var Fe=Te,Be=n(384),Le=function(){var e=Object(te.a)("translation").i18n;return Object(Q.jsx)(Ce.a,{select:!0,label:"Language",variant:"outlined",size:"small",fullWidth:!0,value:e.language,onChange:function(t){e.changeLanguage(t.target.value)},children:W.map((function(e){return Object(Q.jsx)(Be.a,{value:e.code,children:e.lang},e.code)}))})},Ie=function(){var e=_(),t=e.settingsOpen,n=e.settingsToggled;return Object(Q.jsx)(be,{variant:"temporary",anchor:"right",open:t,onClose:n,children:Object(Q.jsx)(ue.a,{p:3,children:Object(Q.jsx)(Le,{})})})},Ne=Object(ee.a)((function(e){return{root:{display:"flex",minHeight:"100vh"},content:{flexGrow:1,overflow:"hidden",padding:e.spacing(3)}}})),ze=function(e){var t=e.children,n=Object(J.a)(e,["children"]),r=Ne();return Object(Q.jsxs)($,{children:[Object(Q.jsxs)("div",{className:r.root,children:[Object(Q.jsx)(le,Object(x.a)({},n)),Object(Q.jsx)("main",{className:r.content,children:t})]}),Object(Q.jsx)(Ie,{})]})},Ee=ye((function(){return null})),Me=n(102),Re=n(371),Ae=n(372),He=n(385),We=n(380),Ue=n(373),De=n(374),qe={username:"",password:""},Ge=Me.a().shape({username:Me.b().required(),password:Me.b().required()}),Ke=Object(ee.a)((function(e){return{container:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",minHeight:"calc(100vh - ".concat(e.mixins.toolbar.minHeight,"px)")},avatar:{width:e.spacing(8),height:e.spacing(8),backgroundColor:e.palette.primary.main}}})),Je=Object(s.b)((function(e){return{isLoading:me(e),error:ve(e)}}),(function(e){return Object(x.a)({},Object(g.b)({login:N},e))})),Ve=Object(g.d)(ye,Je)((function(e){var t=e.isLoading,n=e.error,r=e.login,a=Ke(),i=Object(te.a)(["typography","form","button"]).t;return Object(Q.jsx)(Re.a,{className:a.container,maxWidth:"xs",children:Object(Q.jsx)(Oe.Formik,{initialValues:qe,validationSchema:Ge,onSubmit:function(e){r(e)},children:Object(Q.jsx)(Fe,{children:Object(Q.jsxs)(Ae.a,{container:!0,spacing:2,children:[Object(Q.jsx)(Ae.a,{item:!0,xs:12,align:"middle",children:Object(Q.jsx)(He.a,{className:a.avatar,children:Object(Q.jsx)(Ue.a,{fontSize:"large"})})}),Object(Q.jsx)(Ae.a,{item:!0,xs:12,align:"middle",children:Object(Q.jsx)(ae.a,{component:"h1",variant:"h5",children:i("typography:heading.signIn")})}),n&&Object(Q.jsx)(Ae.a,{item:!0,xs:12,children:Object(Q.jsx)(We.a,{severity:"error",children:n})}),Object(Q.jsx)(Ae.a,{item:!0,xs:12,children:Object(Q.jsx)(Fe.Input,{label:i("form:label.username"),name:"username",InputProps:{startAdornment:Object(Q.jsx)(De.a,{})}})}),Object(Q.jsx)(Ae.a,{item:!0,xs:12,children:Object(Q.jsx)(Fe.Input,{type:"password",label:i("form:label.password"),name:"password",InputProps:{startAdornment:Object(Q.jsx)(Ue.a,{})}})}),Object(Q.jsx)(Ae.a,{item:!0,xs:12,align:"middle",children:Object(Q.jsx)(Fe.Submit,{disabled:t,fullWidth:!0,children:i("button:signIn")})})]})})})})})),Qe=function(e){return Object(Q.jsx)(ze,Object(x.a)(Object(x.a)({},e),{},{children:Object(Q.jsxs)(K.c,{children:[Object(Q.jsx)(K.a,{exact:!0,path:"/",component:Ve}),Object(Q.jsx)(K.a,{path:"",component:Ee})]})}))},Xe=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,388)).then((function(t){var n=t.getCLS,r=t.getFID,a=t.getFCP,i=t.getLCP,c=t.getTTFB;n(e),r(e),a(e),i(e),c(e)}))},Ye=function(e){var t={key:"root",version:1,storage:p.a},n=Object(O.a)({reducer:Object(h.g)(t,M),middleware:[].concat(Object(b.a)(Object(O.f)({serializableCheck:{ignoredActions:[h.a,h.f,h.b,h.c,h.d,h.e]}})),[]),preloadedState:e,devTools:!1});return{store:n,persistor:Object(h.h)(n)}}({}),Ze=Ye.store,$e=Ye.persistor;c.a.render(Object(Q.jsx)(a.a.Suspense,{fallback:null,children:Object(Q.jsx)(s.a,{store:Ze,children:Object(Q.jsx)(o.a,{loading:null,persistor:$e,children:Object(Q.jsx)(l.a,{i18n:U,children:Object(Q.jsx)(u.a,{theme:G,children:Object(Q.jsxs)(j.a,{basename:"/ad",children:[Object(Q.jsx)(d.a,{}),Object(Q.jsx)(Qe,{})]})})})})})}),document.getElementById("root")),Xe()}},[[331,1,2]]]);
//# sourceMappingURL=main.675f396d.chunk.js.map